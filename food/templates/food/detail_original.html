{% extends "layout.html" %}

{% block content %}
<html>
  <head>

  </body>
</html>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
    <!--버튼용 -->
    <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
    <script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>
<script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDJG-bVA-9JCqT9FVFoYz5OWRfRr0g9LhQ&callback=initMap">
</script>

<script>
function initMap() {
    var map = new google.maps.Map(document.getElementById('map'), {
      zoom: 14,
      center: {lat: 37.45886, lng: 126.95}
    });
    setMarkers(map);
}

    var restaurants=[
    ['자하연 식당',37.4610126,126.9501219],
    ['감골 식당',37.4637651,126.9490199],
    ['동원관',37.4640802,126.9495671],
    ['302 식당',37.4502747,126.9534753],
    ];

function setMarkers(map){
  for (var i = 0; i < restaurants.length; i++) {
    var restaurant = restaurants[i];
    var marker = new google.maps.Marker({
    animation: google.maps.Animation.DROP,
    draggable: true,
    map: map,
    title:restaurant[0],
    position:{lat:restaurant[1], lng:restaurant[2]},
    // marker.addListener('click', toggleBounce),
  });

    }
}

<h2>식당 리스트</h2>
{% if restaurant_dict %}
    <ul>
        {% for restaurant in restaurant_dict %}
        <li>
            <a href="{% url 'restaurant' school.shortname restaurant.0 %}">{{restaurant.0}}</a>
            <ol>
                {% for meals in restaurant.1 %}
                <li>
                    {{meals.0}}
                    <ul>
                        {% for meal in meals.1 %}
                        <li class = 'meal' id='{{meal.id}}'>
                            {{meal}}
                        </li>
                        <table>
                        <form action="" method="get">
                        <table>{{ form.as_table }}</table>
                        </form>
                        </table>
                        {% endfor %}
                    </ul>
                </li>
                {% endfor %}
            </ol>

        </a>
        </li>
        {% endfor%}
    </ul>
{% else %}
    <p> 밥이 엄서요 </p>
{% endif %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script>
    $(document).ready(function(){
        $('.meal').click(function(){
            var t = $(this)[0];
            var tstr = 'target' + t.id;
            var target = '#'+tstr;
            if ($(target).length==0){
                $.ajax({
                url : 'history/',
                type: 'GET',
                data : {'meal':t.id},
                success:function(data){
                    var p = document.createElement('div');
                    p.innerHTML = data;
                    p.setAttribute('style','display: none');
                    p.setAttribute('id',tstr);
                    t.append(p);
                    $(target).slideDown("slow");
                }
                });
            } else {
                if ($(target).attr("style") == 'display: none;') {
                    $(target).slideDown("slow");
                } else {
                    $(target).slideUp("slow");
                }
            }
        });
    });
</script>
{% endblock %}
-
